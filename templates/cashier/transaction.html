<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>WebAdmin - Responsive Admin Dashboard Template</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta content="Admin Dashboard" name="description" />
        <meta content="ThemeDesign" name="author" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <link rel="shortcut icon" href="{{ url_for('static', filename='assets/images/favicon.ico') }}">

        <link href="{{ url_for('static', filename='assets/css/bootstrap.min.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ url_for('static', filename='assets/css/icons.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ url_for('static', filename='assets/css/style.css') }}" rel="stylesheet" type="text/css">

    </head>


    <body class="fixed-left">

        <!-- Begin page -->
        <div id="wrapper">

            <!-- Top Bar Start -->
            <div class="topbar">
                <!-- LOGO -->
                <div class="topbar-left">
                    <div class="text-center">
                        <a href="dashboard.html" class="logo"><span>Parking</span>Area</a>
                        <a href="dashboard.html" class="logo-sm"><span>P</span></a>
                        <!--<a href="index.html" class="logo"><img src="assets/images/logo_white_2.png" height="28"></a>-->
                        <!--<a href="index.html" class="logo-sm"><img src="assets/images/logo_sm.png" height="36"></a>-->
                    </div>
                </div>
                <!-- Button mobile view to collapse sidebar menu -->
                <div class="navbar navbar-default" role="navigation">
                    <div class="container">
                        <div class="">
                            <div class="pull-left">
                                <button type="button" class="button-menu-mobile open-left waves-effect waves-light">
                                    <i class="ion-navicon"></i>
                                </button>
                                <span class="clearfix"></span>
                            </div>
                            <form class="navbar-form pull-left" role="search">
                                <div class="form-group">
                                    <input type="text" class="form-control search-bar" placeholder="Search...">
                                </div>
                                <button type="submit" class="btn btn-search"><i class="fa fa-search"></i></button>
                            </form>

                            <ul class="nav navbar-nav navbar-right pull-right">
                                <li class="dropdown hidden-xs">
                                    <a href="#" data-target="#" class="dropdown-toggle waves-effect waves-light notification-icon-box" data-toggle="dropdown" aria-expanded="true">
                                        <i class="fa fa-bell"></i> <span class="badge badge-xs badge-danger"></span>
                                    </a>
                                    <ul class="dropdown-menu dropdown-menu-lg">
                                        <li class="text-center notifi-title">Notifikasi <span class="badge badge-xs badge-success">3</span></li>
                                        <li class="list-group">
                                           <!-- list item-->
                                           <a href="javascript:void(0);" class="list-group-item">
                                              <div class="media">
                                                 <div class="media-heading">Peringatan Lokasi</div>
                                                 <p class="m-0">
                                                   <small>Parkir Area A3 terjadi kerusakan</small>
                                                 </p>
                                              </div>
                                           </a>
                                           <!-- list item-->
                                            <a href="javascript:void(0);" class="list-group-item">
                                              <div class="media">
                                                 <div class="media-body clearfix">
                                                    <div class="media-heading">Kapasitas Area</div>
                                                    <p class="m-0">
                                                       <small>Parkir E5 Full</small>
                                                    </p>
                                                 </div>
                                              </div>
                                            </a>
                                           <!-- last list item -->
                                            <a href="javascript:void(0);" class="list-group-item">
                                              <small class="text-primary">Semua Notifikasi</small>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="hidden-xs">
                                    <a href="#" id="btn-fullscreen" class="waves-effect waves-light notification-icon-box"><i class="mdi mdi-fullscreen"></i></a>
                                </li>
                                <li class="dropdown">
                                    <a href="" class="dropdown-toggle profile waves-effect waves-light" data-toggle="dropdown" aria-expanded="true">
                                        <img src="{{ url_for('static', filename='assets/images/users/avatar-1.jpg') }}" alt="user-img" class="img-circle">
                                        <span class="profile-username">
                                            Linggar <br/>
                                            <small>Cashier</small>
                                        </span>
                                    </a>
                                    <ul class="dropdown-menu">
                                        <li><a href="javascript:void(0)"> Profil</a></li>
                                        <li><a href="javascript:void(0)"><span class="badge badge-success pull-right">5</span> Pengaturan </a></li>
                                        <li class="divider"></li>
                                        <li><a href="javascript:void(0)"> Keluar</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                        <!--/.nav-collapse -->
                    </div>
                </div>
            </div>
            <!-- Top Bar End -->


            <!-- ========== Left Sidebar Start ========== -->

            <div class="left side-menu">
                <div class="sidebar-inner slimscrollleft">

                    <div class="user-details">
                        <div class="text-center">
                            <img src="{{ url_for('static', filename='assets/images/users/avatar-1.jpg') }}" alt="" class="img-circle">
                        </div>
                        <div class="user-info">
                            <div class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Linggar</a>
                            </div>

                            <p class="text-muted m-0"><i class="fa fa-dot-circle-o text-success"></i> Online</p>
                        </div>
                    </div>
                    <!--- Divider -->


                    <div id="sidebar-menu">
                        <ul>
                            <li>
                                <a href="{{ url_for('cashierDashboard') }}" class="waves-effect"><i class="mdi mdi-home"></i><span>Dashboard</span></a>
                            </li>

                            <li>
                                <a href="{{ url_for('cashierTransaction') }}" class="waves-effect"><i class="mdi mdi-home"></i><span>Parking Transaction </span></a>
                            </li>
                        </ul>
                    </div>
                    <div class="clearfix"></div>
                </div> <!-- end sidebarinner -->
            </div>
            <!-- Left Sidebar End -->

            <!-- Start right Content here -->

            <div class="content-page">
                <!-- Start content -->
                <div class="content">

                    <div class="">
                        <div class="page-header-title">
                            <h4 class="page-title">Parking Transaction</h4>
                        </div>
                    </div>

                    <div class="page-content-wrapper ">
                        <form action="{{ url_for('cashierpPayment') }}" method="POST">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="panel panel-color panel-primary">
                                        <div class="panel-heading">
                                            <h3 class="panel-title">Plate Number</h3>
                                        </div>
                                        <div class="panel-body">
                                            <p><h1><center>{{ plateNumber }}</center></h1></p>
                                            <input type="hidden" name="transactionId" id="transactionId" value="">
                                            <input type="hidden" name="plateNumber" id="plateNumber" value="">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                	<div class="row">
                                		<div class="col-sm-8">
		                                    <div class="panel panel-color panel-success">
		                                        <div class="panel-heading">
		                                            <h3 class="panel-title">Biaya Parkir</h3>
		                                        </div>
		                                        <div class="panel-body">
		                                            <p><h1>IDR. {{ fee }},-</h1>
		                                            <input type="hidden" value="" name="total_biaya" id="total_biaya">
		                                            </p>
		                                        </div>
		                                    </div>
		                                </div>
		                                <div class="col-sm-4">
		                                    <div class="panel panel-color panel-info">
		                                        <div class="panel-heading">
		                                            <h3 class="panel-title">Lama Parkir</h3>
		                                        </div>
		                                        <div class="panel-body">
		                                            <p><h4>{{ time }} Jam</h4>
                                                    <input type="hidden" name="mountTime" id="mountTime" value="">
		                                            </p>
		                                        </div>
		                                    </div>
		                                </div>
		                            </div>
                                </div>
                            </div>
                            <!-- end row -->

                            <div class="row">
                                <div class="col-sm-6">
                                	<div class="row">
                                		<div class="col-sm-6">
		                                    <div class="panel panel-color panel-success">
		                                    	<div class="panel-heading">
		                                            <h3 class="panel-title">Start Time Parking</h3>
		                                        </div>
		                                        <div class="panel-body">
		                                            <h2><i class="fa fa-clock-o"></i> <b>{{ startTime }} <span class="clock-time"></span></b></h2>
                                                    <input type="hidden" name="startTime" id="startTime" value="">
		                                        </div>
		                                    </div>
	                                    </div>
	                                    <div class="col-sm-6">
		                                    <div class="panel panel-color panel-danger">
		                                    	<div class="panel-heading">
		                                            <h3 class="panel-title">End Time Parking</h3>
		                                        </div>
		                                        <div class="panel-body">
		                                            <h2><i class="fa fa-clock-o"></i> <b>{{ endtime }} <span class="clock-time"></span></b></h2>
                                                    <input type="hidden" name="endTime" id="endTime" value="">
		                                        </div>
		                                    </div>
	                                    </div>
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <ul class="nav nav-tabs navtab-bg nav-justified">
                                        <li class="active">
                                            <a href="#cash" data-toggle="tab" aria-expanded="true">
                                                <span class="visible-xs"><i class="fa fa-home"></i></span>
                                                <span class="hidden-xs">Cash</span>
                                            </a>
                                        </li>
                                        <li class="">
                                            <a href="#wallet" data-toggle="tab" aria-expanded="false">
                                                <span class="visible-xs"><i class="fa fa-user"></i></span>
                                                <span class="hidden-xs">Wallet</span>
                                            </a>
                                        </li>
                                    </ul>
                                    <div class="tab-content">
                                        <div class="tab-pane active" id="cash">
                                            <div class="form-group">
                                                <label>Bayar</label>
                                                <input type="text" class="form-control bayar" name="bayar" id="bayar" required onkeyup="kembali(this);"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Kembalian</label>
                                                <input type="text" class="form-control" name="kembalian" readonly="" value="0" id="kembalian_bayar" />
                                            </div>
                                            <div class="form-group">
                                                <button type="submit" name="paySubmit" id="paySubmit" class="form-control btn btn-info">Submit Payment</button>
                                            </div>
                                        </div>
                                        <div class="tab-pane " id="wallet">
                                            <p>Isi Payment Method Wallet</p>
                                        </div>
                                    </div>
                                </div>

                        </div><!-- container -->

                    </div> <!-- Page content Wrapper -->
                    </form>
                </div> <!-- content -->

                <footer class="footer">
                    © 2016 WebAdmin - All Rights Reserved.
                </footer>

            </div>
            <!-- End Right content here -->

        </div>
        <!-- END wrapper -->


        <!-- jQuery  -->
        <script src="{{ url_for('static', filename='assets/js/jquery.min.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/bootstrap.min.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/modernizr.min.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/detect.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/fastclick.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/jquery.slimscroll.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/jquery.blockUI.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/waves.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/wow.min.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/jquery.nicescroll.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/jquery.scrollTo.min.js') }}"></script>

        <script src="{{ url_for('static', filename='assets/js/app.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/checkinput.js') }}"></script>

         <script type="text/javascript">

            var paymentCash = JSON.parse({{ cashier|tojson|safe }})
			console.log(paymentCash)
			console.log(paymentCash['transaction_id'])
			fee_parkir = parseInt(paymentCash['fee'])

			document.getElementById('transactionId').value = paymentCash['transaction_id']
			document.getElementById('plateNumber').value = paymentCash['plateNumber']
			document.getElementById('total_biaya').value = fee_parkir
			document.getElementById('mountTime').value = paymentCash['mountTime']
			document.getElementById('startTime').value = paymentCash['startTime']
			document.getElementById('endTime').value = paymentCash['endTime']


            /* textbox bayar */
            var tanpa_rupiah = document.getElementById('bayar');
            tanpa_rupiah.addEventListener('keyup', function(e)
            {
                tanpa_rupiah.value = formatRupiah(this.value);
            });
            tanpa_rupiah.addEventListener('keydown', function(event)
            {
                limitCharacter(event);
            });

            /* Dengan Rupiah */
            var dengan_rupiah = document.getElementById('kembalian_bayar');
            dengan_rupiah.addEventListener('keyup', function(e)
            {
                dengan_rupiah.value = formatRupiah(this.value, 'Rp. ');
            });
                dengan_rupiah.addEventListener('keydown', function(event)
            {
                limitCharacter(event);
            });

            /* Fungsi */
            function formatRupiah(bilangan, prefix)
            {
                var number_string = bilangan.replace(/[^,\d]/g, '').toString(),
                    split   = number_string.split(','),
                    sisa    = split[0].length % 3,
                    rupiah  = split[0].substr(0, sisa),
                    ribuan  = split[0].substr(sisa).match(/\d{1,3}/gi);

                if (ribuan) {
                    separator = sisa ? '.' : '';
                    rupiah += separator + ribuan.join('.');
                }

            rupiah = split[1] != undefined ? rupiah + ',' + split[1] : rupiah;
            return prefix == undefined ? rupiah : (rupiah ? 'Rp. ' + rupiah : '');
            }

            function limitCharacter(event)
            {
                key = event.which || event.keyCode;
                if ( key != 188 // Comma
                    && key != 8 // Backspace
                    && key != 17 && key != 86 & key != 67 // Ctrl c, ctrl v
                    && (key < 48 || key > 57) // Non digit
                    // Dan masih banyak lagi seperti tombol del, panah kiri dan kanan, tombol tab, dll
                    )
            {
                event.preventDefault();
                return false;
            }
            }


            $(document).ready(function() {
                $('.bayar').focus();
            });


            function convertToRupiah(angka){
                var rupiah = '';
                var angkarev = angka.toString().split('').reverse().join('');
                for(var i = 0; i < angkarev.length; i++) if(i%3 == 0) rupiah += angkarev.substr(i,3)+'.';
                return rupiah.split('',rupiah.length-1).reverse().join('');
            }

            function kembali(obj) {
			    var bayar       	= obj.value;
			    var total_biaya		= document.getElementById('total_biaya').value;
			    var kembalian_bayar = document.getElementById('kembalian_bayar');
			    var kembalian       = 0;
			    var angka = parseInt(bayar.replace(/,.*|[^0-9]/g, ''), 10);




			    if(obj.value != ""){
		        	kembalian = angka-parseInt(total_biaya);
		        	refund = convertToRupiah(kembalian)
		        	kembalian_bayar.value = refund;

		        }
		        else{
		        	kembalian_bayar.value = 0;
		        }			    
			}



        </script>

    </body>
</html>